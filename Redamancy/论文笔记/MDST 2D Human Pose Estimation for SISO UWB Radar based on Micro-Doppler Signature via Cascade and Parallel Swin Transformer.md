这篇论文的背景源于近年来智能无线感知系统在复杂城市环境中的迅猛发展，研究人员致力于通过无线信号来感知和理解人类行为。这类系统在自动驾驶、国防监控、以及老年和残疾人辅助等多个领域中展现了巨大的应用潜力。论文提出了一个新颖的基于单输入单输出超宽带雷达(SISO UWB Radar)的2D人体姿态估计方法，利用微多普勒(MD)特征结合层叠与并行Swin Transformer网络实现精确的人体姿态识别。

提出这一研究的原因包括现有雷达成像技术在环境变化下的不稳定性，以及现有数据集在标注和雷达成像质量方面的局限性。为了克服这些挑战，研究引入了一个新的数据集（HPSUR），并设计了一个基于MD特征的Swin Transformer网络，旨在提高人体姿态估计的精确度和鲁棒性。

这篇论文确实提到了隐私问题。当前的摄像头基于的人体姿态估计算法在隐私保护方面存在挑战，因为摄像头监控会涉及到个人隐私的泄露问题。此外，摄像头的监控数据可能会被黑客攻击，导致敏感信息的泄露。相比之下，基于雷达的感知系统由于其强大的穿透能力和对环境因素（如衣物、背景、光照和遮挡）的低敏感性，被认为在隐私保护方面具有优势。这些系统不依赖于视觉信息，因此可以避免摄像头监控带来的隐私问题，提供了更为安全和可靠的人体姿态估计方法。

反卷积层（Transposed Convolution Layer），有时也称为反向卷积层或上采样层，主要用于卷积神经网络（CNN）中进行特征图的上采样（即增大特征图的空间尺寸）。它的主要作用包括以下几点：

1. **上采样（Upsampling）**：反卷积层的主要作用是将低分辨率的特征图恢复为更高分辨率的特征图，通常在图像生成、超分辨率任务或者语义分割任务中使用。通过学习到的权重，反卷积层可以将输入的特征图转换为更大的输出特征图，同时保持空间结构的信息。

2. **恢复空间信息**：在某些任务（如图像重建）中，原始卷积操作会对输入特征图进行下采样（通过池化或卷积），从而丢失一部分空间信息。反卷积层可以恢复这些被丢失的信息，重新生成输入图像或生成更高分辨率的输出图像。

3. **学习上采样**：与固定的上采样方法（如双线性插值）不同，反卷积层是一个可学习的层，能够通过反向传播调整其参数，以优化生成结果。因此，它在恢复细节和生成逼真的高分辨率输出方面具有更好的表现。

4. **配合卷积层使用**：在编码器-解码器结构（如 U-Net 或 GANs 中的生成器）中，反卷积层通常用于解码器部分，将经过卷积和池化处理的低分辨率特征图逐步上采样到与输入图像相同的分辨率。

总之，反卷积层的主要作用在于通过学习的方式对特征图进行上采样和空间信息恢复，是卷积神经网络中常用的工具，尤其在图像生成和语义分割等任务中表现尤为重要。
***
![[Pasted image 20240828200410.png]]
微多普勒光谱图
***
论文提出了一种基于**SISO（单输入单输出）超宽带（UWB）雷达**的二维人体姿态识别方法，利用了**微多普勒（Micro-Doppler, MD）特征**，通过**层叠和并行的Swin Transformer** 网络结构来实现对人体姿态的精确估计。以下是论文的识别姿态的根本方法的概述：

### 1. **数据预处理：**
- 首先，对雷达回波数据进行预处理，包括直接波抑制和自适应滤波，以去除杂波，改善信噪比。
- 然后使用**短时傅里叶变换（STFT）**生成人体姿态的微多普勒光谱图。这些光谱图作为模型的输入，反映了人体各个部位运动所产生的频率变化。

### 2. **MD特征提取：**
- 将生成的微多普勒光谱图嵌入成若干小的图块（patches），这些图块作为Transformer模型的输入。
- 在此基础上，引入了绝对位置嵌入（absolute positional embedding）来增加输入的位置信息，有助于在训练过程中捕捉姿态特征。

### 3. **使用Swin Transformer进行姿态估计：**
- 论文设计了一种**微多普勒Swin Transformer（MDST）**网络，用于从MD光谱图中提取人体姿态信息。该网络包含了四个顺序连接的阶段，每个阶段进一步细化和转换MD特征。
- 通过引入**窗口多头自注意力（W-MSA）**和**移位窗口多头自注意力（SW-MSA）**，网络分别处理MD光谱图中的内帧（inner-frame）特征和帧间（intra-frame）特征。

### 4. **层叠和并行网络结构：**
- MDST网络在原始Swin Transformer基础上设计了**层叠（Cascade）和并行（Parallel）Swin Transformer模块**，以增强本地和全局特征的提取能力。
  - **层叠结构（Cascade Swin Transformer）**：用于逐层细化特征表示，适合提取更高层次的姿态特征。
  - **并行结构（Parallel Swin Transformer）**：用于同时处理多尺度的MD特征，优化对不同分辨率下的姿态估计。

### 5. **反转特征金字塔网络（IFPN）：**
- 在MDST之后，引入了一个**反转特征金字塔网络（IFPN）**来进行多尺度特征融合。该网络通过多层特征图的上采样和融合，增强了对复杂姿态的识别能力。

### 6. **解码与姿态预测：**
- 使用解码器模块对特征进行反卷积和全连接操作，以生成人体各关键点的热图（heatmap），然后通过argmax操作提取每个关键点的二维坐标。

### 总结
论文的根本方法是利用SISO UWB雷达捕获的人体运动微多普勒特征，通过MDST网络结构（包括层叠和并行Transformer模块）以及IFPN进行多尺度特征融合，最终生成人体关键点的二维坐标，实现人体姿态的精确估计。

***
[nesl/RadHAR: Human Activity Recognition from Point Clouds Generated through a Millimeter-wave Radar (github.com)](https://github.com/nesl/RadHAR/tree/master)
这是由SISO超宽带（UWB）雷达采集的原始数据与训练的一个项目
***
在学术界中，雷达原始数据的可视化主要围绕着展示目标运动特征和信号特性，常用的方法包括以下几种：

### 1. **距离-时间图（Range-Time Plot）**

- **方法描述**：距离-时间图用于展示目标在不同时间点上的距离变化，是学术界中常用的雷达数据可视化方法之一。
- **用途**：主要用于分析目标的运动行为，例如目标的距离变化、速度变化等。在研究动态目标检测与跟踪时，尤其有效。
- **实现方法**：
    - 在快时间（fast-time）轴上对雷达回波信号进行采样，通过慢时间（slow-time）轴上的多个脉冲来观察目标的距离变化。
    - 绘制二维图像，其中x轴代表慢时间，y轴代表快时间，颜色或灰度级别表示回波信号的强度或反射强度。

### 2. **距离-多普勒图（Range-Doppler Map）**

- **方法描述**：距离-多普勒图通过在快时间域上执行傅里叶变换生成，展示了目标在不同距离和多普勒频率（速度）上的反射信号强度。
- **用途**：广泛用于目标检测、速度估计、目标分类等研究。它能够同时展示目标与雷达的相对距离和速度信息。
- **实现方法**：
    - 对每个快时间脉冲序列使用快速傅里叶变换（FFT）来生成距离单元。
    - 在慢时间上对多个距离单元执行傅里叶变换，以得到目标的多普勒频谱。
    - 绘制二维图像，x轴为距离（range），y轴为多普勒频率，颜色表示反射强度。

### 3. **微多普勒频谱图（Micro-Doppler Spectrogram）**

- **方法描述**：微多普勒频谱图是使用短时傅里叶变换（STFT）将原始雷达信号投射到时间-频率域中的一种可视化方法，能够展示由目标微动（例如人体的四肢运动）引起的多普勒频率变化。
- **用途**：常用于识别人类活动、手势识别、无人机识别等领域。该图能够揭示目标运动中的细微变化。
- **实现方法**：
    - 将每个雷达回波信号分段，使用短时傅里叶变换（STFT）或连续小波变换（CWT）生成微多普勒图。
    - 绘制二维图像，x轴为时间，y轴为频率，颜色或灰度级别表示频率处的反射强度。

### 4. **距离-角度图（Range-Angle Map）**

- **方法描述**：距离-角度图用于展示目标在不同角度和距离下的回波强度。
- **用途**：用于多目标跟踪、角度估计、目标分辨等。主要应用于MIMO（多输入多输出）雷达系统。
- **实现方法**：
    - 对雷达回波信号进行波束形成（Beamforming）处理。
    - 绘制二维图像，x轴为距离，y轴为角度，颜色表示反射强度。

### 5. **时频分析图（Time-Frequency Analysis Plot）**

- **方法描述**：使用时频分析技术（例如STFT或Wigner-Ville分布）来同时表示时间和频率信息，突出频率分量随时间的变化。
- **用途**：用于分析复杂目标的动态行为（如人类走路、跑步等）或者识别特定的目标活动模式。
- **实现方法**：
    - 通过STFT、CWT或Wigner-Ville分布将雷达回波信号转化为时频图。
    - x轴为时间，y轴为频率，颜色表示频谱强度。

### 6. **三维点云图（3D Point Cloud Map）**

- **方法描述**：三维点云图用于可视化雷达数据中目标的三维位置分布，通过显示目标在x、y、z坐标系中的位置。
- **用途**：用于识别和分类复杂目标形状和运动特征（如自动驾驶中的行人和车辆检测）。
- **实现方法**：
    - 提取每个雷达回波的三维坐标（x, y, z）信息，生成三维散点图。
    - 使用3D可视化工具（如Matplotlib的`plot3D`或PCL库）绘制。

### 总结

学术界常用的雷达数据可视化方法主要包括距离-时间图、距离-多普勒图、微多普勒频谱图、距离-角度图、时频分析图和三维点云图。这些方法各有用途，具体选择取决于研究的目标和数据的特征。可视化结果能够帮助研究人员更好地理解和分析雷达数据中的目标行为和信号特性。
***
SISO超宽带（UWB）雷达采集的原始数据通常包含一系列反映目标和环境信息的测量值。这些数据的格式会根据雷达制造商和应用程序的具体实现而有所不同，但典型的原始数据格式通常包括以下几种关键字段：

### 1. **序列号（seq）**
- 表示数据包的序列编号，用于识别和排序多个雷达数据帧，确保数据的顺序处理。

### 2. **时间戳（timestamp）**
- **秒（secs）**和**纳秒（nsecs）**：两个字段结合形成完整的时间戳，表示每个数据包被采集的精确时间。时间戳是慢时间（slow-time）的基础，用于测量不同雷达脉冲之间的时间间隔。

### 3. **点ID（point_id）**
- 每个目标点或反射点的唯一标识符，帮助区分在同一帧中的多个目标或反射点。

### 4. **三维坐标（x, y, z）**
- 目标点在雷达坐标系中的三维空间位置，通常以米为单位。
  - **x**: 水平位置坐标。
  - **y**: 垂直位置坐标。
  - **z**: 深度或高度坐标。

### 5. **距离（range）**
- 雷达到目标的距离（以米为单位）。这是基于回波信号的飞行时间（Time of Flight, ToF）计算得出的，通常是目标距离估计的一个直接量度。

### 6. **速度（velocity）**
- 目标相对于雷达的径向速度（以米/秒为单位）。通过多普勒频移计算得到，反映目标的移动方向和速度。

### 7. **多普勒频谱分箱值（doppler_bin）**
- 表示多普勒频谱中的分箱值，用于识别不同频率范围内的信号强度。用于目标速度的估计。

### 8. **方位角（bearing）**
- 表示目标相对于雷达的方位角（以度为单位），用于测量目标的横向位置或方向。

### 9. **信号强度（intensity）**
- 表示雷达回波的信号强度或功率（通常以dB为单位），反映目标反射的雷达波强度，通常用于目标检测和分类。

### 10. **帧ID（frame_id）**
- 一个字符串或数字标识符，用于标识当前数据所属的雷达帧。多个数据点可以属于同一帧。

### **数据格式的结构**
这些字段通常以一种结构化的格式存储，例如CSV、JSON或二进制文件。以文本格式表示时，每行数据可能表示一个单独的雷达点，包含上述所有字段。以下是一个典型的原始数据条目的示例：

```
seq: 102, stamp: { secs: 1618709984, nsecs: 123456789 }, frame_id: "ti_mmwave", 
point_id: 1, x: 0.5, y: -0.2, z: 1.5, range: 5.0, velocity: 0.3, doppler_bin: 32, 
bearing: 45.0, intensity: -75.0
```
***
在雷达系统中，**快时间（fast-time）**和**慢时间（slow-time）**是用于描述信号采集和处理的两个重要概念，帮助我们理解雷达如何捕捉目标的位置信息和运动特征。

### 1. **快时间（Fast-Time）**
- **快时间**指的是每个雷达脉冲发出后，接收到目标反射信号的时间。
- 这个时间范围很短，通常是以纳秒或微秒为单位。雷达在发送一个脉冲后，会在非常短的时间内接收到从不同目标反射回来的信号。
- 快时间主要用来计算**目标的距离**。通过测量从雷达发射信号到回波信号返回的时间，可以确定目标的距离（例如：你发出声音后，听到回声的时间差越短，目标越近）。

### 2. **慢时间（Slow-Time）**
- **慢时间**指的是雷达在发出一系列连续脉冲之间的时间间隔。
- 这个时间范围较长，通常以毫秒或秒为单位。雷达发射多个脉冲来持续跟踪目标的运动。
- 慢时间用于分析**目标的速度和运动特征**。通过多次脉冲（每次都记录一个“快时间”数据），雷达可以检测到目标的速度变化（例如：观察汽车在一段时间内的加速或减速情况）。

### 举个例子：
假设你在黑暗中使用手电筒来找一个移动的物体：
- **快时间**就像你打开手电筒的一瞬间，光从手电筒发出并反射回来，这个时间非常短，你用它来估计物体距离。
- **慢时间**就像你每隔一秒钟闪一次手电筒，通过比较每次闪光的回声，你可以判断这个物体是向你移动还是离你远去。

### 总结：
- **快时间**用于测量单个脉冲内目标的距离。
- **慢时间**用于测量多个脉冲之间目标的速度和运动方向。 

这两个时间的结合让雷达系统能够全面地了解目标的静态位置和动态变化。
***
在雷达信号处理中，**直接波抑制**和**自适应滤波**是用来增强目标检测效果的两种信号处理技术，它们主要针对雷达信号中的噪声和干扰进行处理。

### 1. **直接波抑制（Direct Wave Suppression）**

- **直接波**指的是雷达天线发射的信号直接反射回接收器的那部分信号，这部分信号不包含任何关于目标的信息，因为它没有与目标物体发生任何反射或散射。
- **直接波抑制**的目的是去除或减少这部分直接回波的影响，以便更好地检测到来自目标的有用信号。

#### 如何进行处理：
- **时间窗过滤**：通过延迟和滤波，识别并过滤掉早期返回的强信号（通常是直接波），因为这些信号会在非常短的时间内返回到雷达接收器。
- **天线阵列技术**：使用多天线阵列的方向性来区分直接波和来自目标的反射波，或者利用相位和幅度差异来抑制直接波。
- **自适应算法**：采用自适应算法（如自适应自干扰消除）实时检测和抑制直接波信号，进一步减少其影响。

### 2. **自适应滤波（Adaptive Filtering）**

- **自适应滤波**是一种动态调整滤波器参数的方法，用于去除信号中的噪声和不相关干扰，增强感兴趣的目标信号。
- 它通过不断更新滤波器的系数，使其适应信号环境的变化，因此被称为“自适应”。

#### 如何进行处理：
- **噪声抑制**：自适应滤波器可以区分目标信号和噪声信号，通过不断调整滤波器参数，最大程度地保留目标信号的有用信息，并减少不相关的噪声。
- **回波增强**：通过自适应调整滤波器的频率响应，自适应滤波可以加强目标回波信号的特征，使目标信号更加明显。
- **典型方法**：
  - **LMS（最小均方）算法**：通过最小化输出误差的均方值，不断调整滤波器的系数，使得滤波器能够适应当前信号环境的变化。
  - **卡尔曼滤波**：利用统计模型预测和更新信号的状态，在具有较高噪声水平的情况下，更准确地跟踪目标。

### 总结：
- **直接波抑制**专注于消除不包含目标信息的强信号（直接波），防止其干扰有用信号的检测。
- **自适应滤波**则动态调整滤波器参数，以去除噪声和干扰，同时增强感兴趣的目标信号的特征。 
***
生成微多普勒（Micro-Doppler）光谱图的方法主要依赖于将雷达回波信号转换到时间-频率域，以捕捉目标物体（如人或车辆）细微运动（如步态、手势）的频率变化特征。以下是常用的几种方法：

### 1. **短时傅里叶变换（Short-Time Fourier Transform, STFT）**
- **方法描述**：STFT 是最常用的生成微多普勒光谱图的方法。它通过在短时间窗口内对信号进行傅里叶变换，得到信号在时间和频率上的联合表示。
- **实现步骤**：
  1. 将雷达回波信号分成重叠的短时间窗口（如20毫秒）。
  2. 对每个时间窗口内的信号进行傅里叶变换，得到该时间段内的频谱。
  3. 将所有窗口的频谱结果拼接，得到时间-频率域的微多普勒光谱图。
- **优点**：简单、直观，适用于平稳信号的分析。
- **缺点**：时间分辨率和频率分辨率的折衷（即窗口长度的选择影响两者的平衡）。

### 2. **连续小波变换（Continuous Wavelet Transform, CWT）**
- **方法描述**：CWT 使用可变大小的窗口函数来分析信号的不同频率成分，更适合非平稳信号（即信号频率随时间变化）。
- **实现步骤**：
  1. 选择一个母小波（如Morlet小波）和尺度范围。
  2. 对信号进行连续小波变换，得到信号在不同时间和频率尺度下的系数。
  3. 将小波系数的绝对值平方，得到时间-频率域的功率谱密度，即微多普勒光谱图。
- **优点**：能够提供高时间和频率分辨率，适合分析非平稳信号。
- **缺点**：计算复杂度较高，需要选择合适的母小波和尺度范围。

### 3. **Wigner-Ville分布（Wigner-Ville Distribution, WVD）**
- **方法描述**：WVD 是一种时间-频率分布方法，用于获取信号的高分辨率时间-频率表示。它通过计算自乘积来估计信号的瞬时频率。
- **实现步骤**：
  1. 计算信号的自相关函数。
  2. 对自相关函数的时间延迟变量进行傅里叶变换，得到Wigner-Ville分布。
  3. 绘制WVD图来显示信号的时间-频率特性。
- **优点**：提供高时间和频率分辨率，适用于短时间变化较大的信号。
- **缺点**：可能产生交叉项干扰（cross-terms），使得时间-频率图变得混乱。

### 4. **希尔伯特-黄变换（Hilbert-Huang Transform, HHT）**
- **方法描述**：HHT 结合经验模态分解（Empirical Mode Decomposition, EMD）和希尔伯特谱分析，适用于非线性和非平稳信号。
- **实现步骤**：
  1. 使用经验模态分解将信号分解为若干固有模态函数（IMFs）。
  2. 对每个IMF应用希尔伯特变换，计算其瞬时频率和瞬时幅度。
  3. 将所有IMFs的瞬时频率和幅度整合，得到信号的时间-频率能量谱，即微多普勒光谱图。
- **优点**：适用于非线性、非平稳信号，能够提供信号的本征特征。
- **缺点**：分解过程复杂，容易受到噪声影响。

### 5. **谱估计方法（Spectral Estimation Methods）**
- **方法描述**：通过现代谱估计技术，如自回归（Auto-Regressive, AR）模型、最小方差无畸变响应（Minimum Variance Distortionless Response, MVDR）方法来生成微多普勒图。
- **实现步骤**：
  1. 建立信号的数学模型（如AR模型）来估计其频谱。
  2. 根据估计得到的频谱，绘制时间-频率图。
- **优点**：在低信噪比环境下表现优异，能够获得更精确的频谱估计。
- **缺点**：依赖于模型的正确性，模型选择复杂。

### 6. **离散傅里叶变换（Discrete Fourier Transform, DFT）与快速傅里叶变换（Fast Fourier Transform, FFT）**
- **方法描述**：直接将雷达信号进行离散傅里叶变换（DFT）或快速傅里叶变换（FFT），用于分析固定时间窗口内的频率变化。
- **实现步骤**：
  1. 对信号进行分段。
  2. 对每一段应用DFT或FFT来获得其频谱。
  3. 组合所有段的频谱，形成微多普勒光谱图。
- **优点**：简单快速，易于实现。
- **缺点**：不适用于非平稳信号，时间和频率分辨率受限。

### 总结
生成微多普勒光谱图的方法有很多，选择合适的方法取决于信号特性（如平稳性、非线性）、分析目标（如频率分辨率、时间分辨率）和计算资源（如实时处理需求）。最常用的方法是短时傅里叶变换（STFT），但在处理非平稳信号时，小波变换（CWT）和希尔伯特-黄变换（HHT）可能更为适用。
***
